<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Collaborative Code Competitions</title>
  <meta name="description" content="Up until last year, I was doing all my work on a late 2008 13” Macbook with eight gigs of ram. It wasn’t impossible to do work, but there were some tasks tha...">
  <link rel="stylesheet" href="/assets/main.css">
  <link href="https://fonts.googleapis.com/css?family=Roboto+Mono" rel="stylesheet">
  <link rel="canonical" href="http://localhost:4000/projects/unpublished/design/tech/research/2017/02/07/ccc.html">
  <link rel="alternate" type="application/rss+xml" title="josh shi" href="/feed.xml">

  
</head>


  <body>

    

    <article class="container" itemscope itemtype="http://schema.org/BlogPosting">
  <div class="info-container mono">
    <div class="header-sticky">
      <p><a href="/">Josh Shi</a></p>
    </div>
  </div><div class="post-container serif" itemprop="articleBody">
    <header class="post-header">
      <p class="mono post-title" itemprop="name headline">Collaborative Code Competitions</p>
    </header>
    <p>Up until last year, I was doing all my work on a late 2008 13” Macbook with eight gigs of ram. It wasn’t impossible to do work, but there were some tasks that would take a long time or would start my fan spinning (like launching Illustrator or watching videos on YouTube).</p>

<p>There was one thing, though, that absolutely destroyed me every time I opened up my laptop: the Slack app. I use Slack as my go-to communication app for student groups (for good reason, it’s the best one out there), which means that I was liable to be signed into around five Slack teams at any point in time.</p>

<p>The Slack desktop app is build on Github’s Electron, which in turn uses Chromium on the front-end. Chromium is <a href="http://unix.stackexchange.com/questions/140153/how-to-reduce-chromes-virtual-memory-usage/338111#338111">pretty</a> <a href="https://bugs.chromium.org/p/chromium/issues/detail?id=393395">notorious</a> for being a memory hog, so it’s not hard to see how that could affect desktop applications built on it.</p>

<p><img src="/assets/images/slag/activity-monitor.png" /></p>

<p>This is a screenshot taken on my current work machine, a late 2014 15” Macbook Pro with 16 gigs of ram. At the time this screenshot was taken, I had Slack open for about three minutes. It’s already using up more than a gigabyte of my memory.</p>

<p>And so I enlisted the help of a friend and set out to make a stripped-down version of the Slack desktop app. Our goal was never to try to replace the Slack app completely, but rather to provide a similar experience with a much smaller memory footprint. So while we first set out to implement the larger parts of the Slack app (the messaging, team and channel switching, etc), we also recognized that a lot of the joy of using Slack comes from the little things (emoji, @-mentions, /-commands), and we wanted to recreate those as well.</p>

<p>Thankfully, Slack provides a very helpful <a href="https://api.slack.com/web">web API</a> that had almost everything we needed to build out the messaging part. For the ncurses-like terminal GUI, we used a Javascript library called <a href="https://github.com/chjj/blessed">blessed</a>, along with some components from <a href="https://github.com/yaronn/blessed-contrib">blessed-contrib</a> and a few custom components as well.</p>

<p>/-commands like giphy aren’t exposed in Slack’s public web API, but by looking at network calls in a browser we were able to figure them out. @-mentions required some regex expressions to decipher and assemble. Supporting Slack’s colon-flanked <code>:emoji-code:</code> was a little more of an exercise since Javascript pre-ES6 doesn’t support unicode, but we were able to get it working using surrogate pairs.</p>

<p>With the actual client working, we then worked on improving usability. We put the client on <a href="https://www.npmjs.com/package/slag-cli">npm</a> to make it easier to install, but realized that adding tokens (i.e. providing credentials) for a team was still a pain. We added some useful commands to make it easier as well as a helpful manual for new users.</p>

<p>When all was said and done, we ended up with a Slack terminal client that supported</p>
<ul>
  <li>messaging (no points there)</li>
  <li>team switching (still no points, but a gold sticker for trying)</li>
  <li>native notifications when someone @-mentioned you or sent you a DM</li>
  <li>emoji and Slack’s emoji-code</li>
  <li>/-commands</li>
  <li>@-mentions</li>
  <li>marking channels which had unread messages with an asterisk</li>
</ul>

<p>We also measured our memory usage. This is for a slag client signed into four teams, although results should be comparable across more or fewer team sign-ins.</p>

<p><img src="/assets/images/slag/memory.png" /></p>

<p><em>Note:</em> Slack has since made some <a href="https://slack.engineering/reducing-slacks-memory-footprint-4480fec7e8eb#.79f8z8m33">improvements</a> to the client.</p>

  </div>

  
</article>


    <footer class="footer">
</footer>


  </body>

</html>
